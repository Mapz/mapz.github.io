<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/link-300x300.gif">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/link-300x300.gif">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/link-300x300.gif">
  <link rel="mask-icon" href="/images/link-300x300.gif" color="#222">
  <link rel="manifest" href="/images/manifest.json">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Consolas:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"mapz.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="FIND THE CHILD">
<meta property="og:type" content="website">
<meta property="og:title" content="Mapz&#39;s Blog">
<meta property="og:url" content="http://mapz.github.io/page/2/index.html">
<meta property="og:site_name" content="Mapz&#39;s Blog">
<meta property="og:description" content="FIND THE CHILD">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Mapz">
<meta property="article:tag" content="æ¸¸æˆå¼€å‘,UE4">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://mapz.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Mapz's Blog</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?69c67c43ced4b46e7ba1656a83e9c872";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Mapz's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">å¯ä»¥é€’å½’çš„å‡½æ•°æŒ‡é’ˆ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mapz.github.io/2021/05/25/UE4%EF%BC%9AUGameplayAbility%E7%B1%BB%E5%9E%8B%E7%AE%80%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/link-300x300.gif">
      <meta itemprop="name" content="Mapz">
      <meta itemprop="description" content="FIND THE CHILD">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mapz's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/25/UE4%EF%BC%9AUGameplayAbility%E7%B1%BB%E5%9E%8B%E7%AE%80%E6%9E%90/" class="post-title-link" itemprop="url">UE4ï¼šUGameplayAbility ç±»å‹ç®€æ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-25 11:17:08 / ä¿®æ”¹æ—¶é—´ï¼š17:17:55" itemprop="dateCreated datePublished" datetime="2021-05-25T11:17:08+08:00">2021-05-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä½œä¸º GAS ç³»ç»Ÿä¸­çš„æ ¸å¿ƒå…ƒç´ ä¹‹ä¸€ GameplayAbility ä»£è¡¨ä¸€ä¸ªå¯å¤§å¯å°çš„ â€œèƒ½åŠ›â€</p>
<p>è¿™ä¸ªèƒ½åŠ›èƒ½å¹²å•¥ï¼ŒåŸºæœ¬å…¨é ä½ è‡ªå·±å®šä¹‰çš„è¾¹ç•Œï¼Œå¤§åˆ°ä¸€ä¸ªå¤æ‚çš„æŠ€èƒ½ï¼Œå°åˆ°ä¸€ä¸ªåŠ¨ä½œï¼Œéƒ½å¯ä»¥ä½œä¸ºä¸€ä¸ªâ€œèƒ½åŠ›â€</p>
<p>å¯ä»¥è¯´ GA çš„ç›®çš„æ˜¯åŸºäºä¸€ç³»åˆ—çš„è¡Œä¸ºæ§åˆ¶æ¥ç”Ÿæˆ GameplayEffect æ”¹å˜ GameplayAttribueï¼Œ åˆ›å»º GameplayCue æ¥å¤„ç†æ˜¾ç¤ºå’Œå£°éŸ³æ•ˆæœ</p>
<p>è¿™æ¬¡æˆ‘ä»¬åŸºäº UE ç‰ˆæœ¬ 4.26 æ¥ç®€æä¸€ä¸‹ UGameplayAbility ç±»</p>
<h2 id="åŸºæœ¬ä¿¡æ¯"><a href="#åŸºæœ¬ä¿¡æ¯" class="headerlink" title="åŸºæœ¬ä¿¡æ¯"></a>åŸºæœ¬ä¿¡æ¯</h2><p>ç±»å‹ç»§æ‰¿ UObjectï¼Œå¹¶å®ç° IGameplayTaskOwnerInterface æ¥å£</p>
<p>å®ç° IGameplayTaskOwnerInterface çš„ç›®çš„æ˜¯ä¸ºäº†å¯ä»¥åœ¨å…¶ä¸­æ‰§è¡Œå¼‚æ­¥çš„ UGameplayTask</p>
<p>è€Œ GA ä½¿ç”¨çš„ GameplayTasksComponent æ˜¯ GA çš„å½“å‰é‡Šæ”¾è€…çš„ AbilitySystemComponent ï¼ˆUAbilitySystemComponent ä¹Ÿæ˜¯ç»§æ‰¿è‡ª UGameplayTasksComponent çš„ï¼‰</p>
<h2 id="é‡è¦çš„å‡½æ•°"><a href="#é‡è¦çš„å‡½æ•°" class="headerlink" title="é‡è¦çš„å‡½æ•°"></a>é‡è¦çš„å‡½æ•°</h2><p>å¦‚æºç ä¸­çš„æ³¨é‡Šæ‰€å†™çš„ï¼ŒGA é‡Œé¢æœ‰å‡ ä¸ªé‡è¦çš„å‡½æ•°</p>
<h3 id="CanActivateAbility"><a href="#CanActivateAbility" class="headerlink" title="CanActivateAbility"></a>CanActivateAbility</h3><h4 id="å‡½æ•°å®šä¹‰"><a href="#å‡½æ•°å®šä¹‰" class="headerlink" title="å‡½æ•°å®šä¹‰"></a>å‡½æ•°å®šä¹‰</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">CanActivateAbility</span><span class="params">(<span class="keyword">const</span> FGameplayAbilitySpecHandle Handle, <span class="keyword">const</span> FGameplayAbilityActorInfo* ActorInfo, <span class="keyword">const</span> FGameplayTagContainer* SourceTags = <span class="literal">nullptr</span>, <span class="keyword">const</span> FGameplayTagContainer* TargetTags = <span class="literal">nullptr</span>, OUT FGameplayTagContainer* OptionalRelevantTags = <span class="literal">nullptr</span>)</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°åŠŸèƒ½æ˜¯æ£€æŸ¥æ˜¯å¦å¯ä»¥æ¿€æ´»æ­¤ Ability</p>
<p>GAS ä¸­åœ¨ UAbilitySystemComponent::TryActivateAbility ä¸­è°ƒç”¨</p>
<ul>
<li>Handle å‚æ•°ï¼šAbilitySpcHandleï¼Œè¿™ä¸ªä»£è¡¨ä¸€ä¸ª Ability çš„å®ä¾‹å’Œæ•°æ®è½½ä½“çš„ Handle</li>
<li>ActorInfo å‚æ•°ï¼šå½“å‰æŠ€èƒ½çš„é‡Šæ”¾è€…ä¿¡æ¯ï¼Œç±»å‹ FGameplayAbilityActorInfo åŒ…æ‹¬æŠ€èƒ½æ‰€æœ‰è€…ï¼ŒæŠ€èƒ½ Avatar Actor ï¼ˆä»£è¡¨ç‰©ç†ä¸Šé‡Šæ”¾æŠ€èƒ½çš„ Actorï¼Œå¯ä»¥æ²¡æœ‰ï¼‰å’Œ PC ï¼Œéª¨æ¶ Mesh ï¼Œæ˜¯å¦æœ¬åœ° Actor ç­‰ä¿¡æ¯</li>
<li>SourceTagsï¼šè¡¨ç¤ºé‡Šæ”¾è€…æ‹¥æœ‰çš„ Tags</li>
<li>TargetTagsï¼šè¡¨ç¤ºç›®æ ‡æ‹¥æœ‰çš„ Tags</li>
<li>OptionalRelevantTagsï¼šç”¨æ¥å­˜æ”¾ä¸€äº›é¢å¤–çš„ä¿¡æ¯ï¼Œæœ¬ä½“é‡Œé¢ç”¨æ¥æ”¾æŠ€èƒ½é‡Šæ”¾å¤±è´¥çš„åŸå›  Tags</li>
</ul>
<h4 id="å‡½æ•°é»˜è®¤æµç¨‹"><a href="#å‡½æ•°é»˜è®¤æµç¨‹" class="headerlink" title="å‡½æ•°é»˜è®¤æµç¨‹"></a>å‡½æ•°é»˜è®¤æµç¨‹</h4><p>å‡½æ•°æ˜¯ virtual çš„ï¼Œä½ å¯ä»¥è‡ªå·±é‡å†™</p>
<p>é»˜è®¤æµç¨‹å¦‚ä¸‹</p>
<ol>
<li>åˆ¤æ–­æ˜¯å¦ç¬¦åˆæ‰§è¡Œç­–ç•¥ï¼ˆåªèƒ½åœ¨æœåŠ¡å™¨æ‰§è¡Œï¼Œåªèƒ½åœ¨å®¢æˆ·ç«¯å‘èµ·ä¹‹ç±»çš„ï¼‰</li>
<li>åˆ¤æ–­ ActorInfo ä¸­æ˜¯å¦å«æœ‰ AbilitySystemComponent ï¼Œæ²¡æœ‰åˆ™ä¸å¯ä»¥é‡Šæ”¾</li>
<li>åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç¦æ­¢é‡Šæ”¾æŠ€èƒ½ï¼ˆAbilitySystemComponent.UserAbilityActivationInhibitedï¼Œä¾‹å¦‚èœå•çŠ¶æ€ä¸‹ä¸èƒ½é‡Šæ”¾ä¹‹ç±»çš„)</li>
<li>åˆ¤æ–­æŠ€èƒ½å†·å´æ˜¯å¦å®Œæˆ<blockquote>
<p>å†·å´æ˜¯ç”± TSubclassOf<class UGameplayEffect> CooldownGameplayEffectClass æ¥æ§åˆ¶çš„ï¼Œåœ¨æŠ€èƒ½æˆåŠŸè¢« commit çš„æ—¶å€™ï¼Œä¼šè§¦å‘ç”Ÿæˆè¿™ä¸ª GEï¼Œåˆ¤æ–­æ˜¯å¦å†·å´äº†å°±æ˜¯åˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ª GE</p>
</blockquote>
</li>
<li>åˆ¤æ–­æŠ€èƒ½æ¶ˆè´¹æ˜¯å¦å¤Ÿ<blockquote>
<p>åŒæ ·çš„æ¶ˆè´¹æ˜¯ç”± TSubclassOf<class UGameplayEffect> CostGameplayEffectClass æ¥æ§åˆ¶çš„ï¼Œè¿™ä¸ª GE æ˜¯æ‡’åŠ è½½çš„ï¼Œè¿™é‡Œä¼šè°ƒç”¨ AbilitySystemComponent-&gt;CanApplyAttributeModifiers æ¥æ£€æŸ¥æ˜¯å¦æœ‰èµ„æºé‡Šæ”¾æŠ€èƒ½</p>
</blockquote>
</li>
<li>æ£€æŸ¥å½“å‰ Tags æ˜¯å¦æ»¡è¶³é‡Šæ”¾æ¡ä»¶ï¼ŒåŒ…æ‹¬éœ€è¦çš„ Tagï¼ŒBlock çš„ Tag ç­‰</li>
<li>è·å¾—æŠ€èƒ½å®ä¾‹çš„æŠ€èƒ½ä¿¡æ¯ï¼ˆFGameplayAbilitySpecï¼‰</li>
<li>å¦‚æœç»‘å®šäº†è¾“å…¥ï¼Œæ£€æŸ¥æ˜¯å¦ä¸ºä¸å…è®¸è¾“å…¥çš„æŠ€èƒ½ï¼ˆAbilitySystemComponent-&gt;IsAbilityInputBlockedï¼‰</li>
<li>æ£€æŸ¥è“å›¾è¦†ç›–çš„ K2_CanActivateAbility æ˜¯å¦å¯ä»¥é‡Šæ”¾</li>
</ol>
<h3 id="CallActivateAbility"><a href="#CallActivateAbility" class="headerlink" title="CallActivateAbility"></a>CallActivateAbility</h3><h4 id="å‡½æ•°å®šä¹‰-1"><a href="#å‡½æ•°å®šä¹‰-1" class="headerlink" title="å‡½æ•°å®šä¹‰"></a>å‡½æ•°å®šä¹‰</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CallActivateAbility</span><span class="params">(<span class="keyword">const</span> FGameplayAbilitySpecHandle Handle, <span class="keyword">const</span> FGameplayAbilityActorInfo* ActorInfo, <span class="keyword">const</span> FGameplayAbilityActivationInfo ActivationInfo, FOnGameplayAbilityEnded::FDelegate* OnGameplayAbilityEndedDelegate = <span class="literal">nullptr</span>, <span class="keyword">const</span> FGameplayEventData* TriggerEventData = <span class="literal">nullptr</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°ç”¨æ¥æ¿€æ´» Ability</p>
<p>å‚æ•°é™¤äº†ä¸Šé¢çš„ä»¥å¤–è¿˜æœ‰</p>
<ul>
<li>ActivationInfoï¼šFGameplayAbilityActivationInfo ç±»å‹ï¼Œå­˜å‚¨ä¸€äº›æŠ€èƒ½çš„æ¿€æ´»ä¿¡æ¯ï¼ŒåŒ…æ‹¬ PK å’Œ ActivationMode ï¼ˆæ¿€æ´»çš„æ¨¡å¼ï¼Œ Authority æˆ–è€… Client ç­‰ï¼‰</li>
<li>OnGameplayAbilityEndedDelegateï¼š Ability Ended å›è°ƒ</li>
<li>TriggerEventDataï¼šFGameplayEventData ç±»å‹ï¼ŒåŒ…æ‹¬æŠ€èƒ½å‘èµ·è€…ï¼Œç›®æ ‡ï¼Œç›®æ ‡æ•°æ®ï¼Œå¢å¹…ï¼ŒTagå®¹å™¨ç­‰ï¼Œè¿˜å¯ä»¥ä¼ å…¥ä¸¤ä¸ª Custom çš„ UObject ç”¨æ¥ä¼ é€’æ•°æ®</li>
</ul>
<h4 id="å‡½æ•°ä¸»è¦æµç¨‹"><a href="#å‡½æ•°ä¸»è¦æµç¨‹" class="headerlink" title="å‡½æ•°ä¸»è¦æµç¨‹"></a>å‡½æ•°ä¸»è¦æµç¨‹</h4><ol>
<li>æ‰§è¡Œ PreActivateï¼ˆVirtual å¯è¦†ç›–ï¼‰<br> a. åˆ·æ–°å¯¹é½ ServerMovement<br> b. å¦‚æœæ˜¯å®ä¾‹åŒ–çš„ Activityï¼Œè®¾ç½® bIsActive ä¸ºæ¿€æ´»çŠ¶æ€ï¼Œè®¾ç½®ä¸º bIsBlockingOtherAbilities ä¸º True<br> c. è®¾ç½® Activity çš„å½“å‰ ActorInfo å’Œ ActivationInfo<br> d. åŠ å…¥éœ€è¦æ¿€æ´»çš„ GameplayTags<br> e. åŠ å…¥ AbilityEnded å›è°ƒ<br> f. å‘é€ AbilityActivatedCallbacks äº‹ä»¶<br> g. æ›´æ–° Ability çš„ Blocking å’Œ Cancel Tags</li>
<li>æ‰§è¡Œ ActivateAbilityï¼ˆVirtual å¯è¦†ç›–ï¼‰<br> a. å¦‚æœæœ‰è“å›¾å®ç°ï¼Œåˆ™ä½¿ç”¨è“å›¾å®ç° K2_ActivateAbility æ¿€æ´»ä»»åŠ¡<br> b. å¦‚æœæœ‰è“å›¾çš„ TriggerEvent å®ç°ï¼Œåˆ™æ‰§è¡Œ K2_ActivateAbilityFromEvent(*TriggerEventData) æ¿€æ´»ä»»åŠ¡ï¼Œç­æœ‰ TriggerData åˆ™ End Ability<br> c. å¦‚æœæ²¡æœ‰è“å›¾å®ç°ï¼Œåˆ™ç›´æ¥ Commit Ability</li>
</ol>
<h3 id="CommitAbility"><a href="#CommitAbility" class="headerlink" title="CommitAbility"></a>CommitAbility</h3><h4 id="å‡½æ•°å®šä¹‰-2"><a href="#å‡½æ•°å®šä¹‰-2" class="headerlink" title="å‡½æ•°å®šä¹‰"></a>å‡½æ•°å®šä¹‰</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">CommitAbility</span><span class="params">(<span class="keyword">const</span> FGameplayAbilitySpecHandle Handle, <span class="keyword">const</span> FGameplayAbilityActorInfo* ActorInfo, <span class="keyword">const</span> FGameplayAbilityActivationInfo ActivationInfo, OUT FGameplayTagContainer* OptionalRelevantTags = <span class="literal">nullptr</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°æ˜¯ç¡®è®¤ Ability</p>
<h4 id="é»˜è®¤æµç¨‹"><a href="#é»˜è®¤æµç¨‹" class="headerlink" title="é»˜è®¤æµç¨‹"></a>é»˜è®¤æµç¨‹</h4><ol>
<li>è°ƒç”¨ CommitCheck æ£€æŸ¥æ˜¯å¦å¯ä»¥ Commit ï¼ˆå’Œ CanActivateAbility å·®ä¸å¤šï¼Œä¹Ÿå¯ä»¥åšé¢å¤–çš„æ£€æŸ¥ï¼‰</li>
<li>è®¾ç½®å†·å´ï¼Œæ‰§è¡Œæ¶ˆè€—èµ„æº ï¼ˆApplyCooldown å’Œ ApplyCostï¼‰</li>
<li>æ‰§è¡Œè“å›¾ K2_CommitExecute</li>
<li>å‘é€ AbilityCommittedCallbacks å¹¿æ’­</li>
</ol>
<h3 id="CancelAbility"><a href="#CancelAbility" class="headerlink" title="CancelAbility"></a>CancelAbility</h3><h4 id="å‡½æ•°å®šä¹‰-3"><a href="#å‡½æ•°å®šä¹‰-3" class="headerlink" title="å‡½æ•°å®šä¹‰"></a>å‡½æ•°å®šä¹‰</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">CancelAbility</span><span class="params">(<span class="keyword">const</span> FGameplayAbilitySpecHandle Handle, <span class="keyword">const</span> FGameplayAbilityActorInfo* ActorInfo, <span class="keyword">const</span> FGameplayAbilityActivationInfo ActivationInfo, <span class="keyword">bool</span> bReplicateCancelAbility)</span></span>;</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°ç”¨æ¥å–æ¶ˆ Ability </p>
<h4 id="é»˜è®¤æµç¨‹-1"><a href="#é»˜è®¤æµç¨‹-1" class="headerlink" title="é»˜è®¤æµç¨‹"></a>é»˜è®¤æµç¨‹</h4><ol>
<li>æ£€æŸ¥ Ability æ˜¯å¦å¯ä»¥è¢« Cancel ï¼ˆå¦‚æœæ˜¯éå®ä¾‹åŒ–çš„ï¼Œåˆ™å¯ä»¥è¢« Cancelï¼Œå¦‚æœæ˜¯å®ä¾‹åŒ–çš„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥è¢« Cancel çš„è®¾ç½®ï¼‰</li>
<li>æ£€æŸ¥å½“å‰çš„ Ability æ˜¯å¦æ­£åœ¨ ApplyGameplayEffectSpecToTarget ï¼ˆScopeLockCountï¼‰ï¼Œå¦‚æœæ­£åœ¨è¢«æ“ä½œï¼ŒåŠ å…¥ WaitingToExecute ä¸­ï¼Œå¹¶ä¼šåœ¨æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œæœ¬æ¬¡ Cancel æ“ä½œ</li>
<li>å¦‚æœéœ€è¦ï¼Œæ‰§è¡Œ ReplicateEndOrCancelAbility æ‰§è¡Œå®¢æˆ·ç«¯æˆ–è€…æœåŠ¡å™¨çš„ CancelAbility æˆ–è€… EndAbility çš„ RPC</li>
<li>å¹¿æ’­ OnGameplayAbilityCancelled äº‹ä»¶</li>
<li>æ‰§è¡Œ EndAbility</li>
</ol>
<h3 id="EndAbility"><a href="#EndAbility" class="headerlink" title="EndAbility"></a>EndAbility</h3><h4 id="å‡½æ•°å®šä¹‰-4"><a href="#å‡½æ•°å®šä¹‰-4" class="headerlink" title="å‡½æ•°å®šä¹‰"></a>å‡½æ•°å®šä¹‰</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">EndAbility</span><span class="params">(<span class="keyword">const</span> FGameplayAbilitySpecHandle Handle, <span class="keyword">const</span> FGameplayAbilityActorInfo* ActorInfo, <span class="keyword">const</span> FGameplayAbilityActivationInfo ActivationInfo, <span class="keyword">bool</span> bReplicateEndAbility, <span class="keyword">bool</span> bWasCancelled)</span></span>;</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°ç”¨æ¥ç»“æŸ Ability</p>
<h4 id="é»˜è®¤æµç¨‹-2"><a href="#é»˜è®¤æµç¨‹-2" class="headerlink" title="é»˜è®¤æµç¨‹"></a>é»˜è®¤æµç¨‹</h4><ol>
<li>æ£€æŸ¥ Ability æ˜¯å¦å¯ä»¥è¢« End<br> a. ä¸æ˜¯ Active çš„å®ä¾‹åŒ– Acitivity ä¸å¯ä»¥è¢« End<br> b. æ£€æŸ¥ Handle çš„ ActivitySpec æ˜¯å¦ Active</li>
<li>æŸ¥å½“å‰çš„ Ability æ˜¯å¦æ­£åœ¨ ApplyGameplayEffectSpecToTarget ï¼ˆScopeLockCountï¼‰ï¼Œå¦‚æœæ­£åœ¨è¢«æ“ä½œï¼ŒåŠ å…¥ WaitingToExecute ä¸­ï¼Œå¹¶ä¼šåœ¨æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œæœ¬æ¬¡ EndAbility æ“ä½œ</li>
<li>æ‰§è¡Œè“å›¾ K2_OnEndAbility</li>
<li>æ¸…é™¤è¿™ä¸ª Ability åœ¨ World ä¸­çš„æ‰€æœ‰ timer å’Œ latent actions</li>
<li>å¹¿æ’­ OnGameplayAbilityEnded äº‹ä»¶ï¼Œå¹¶ç§»é™¤å›è°ƒ</li>
<li>å¹¿æ’­ OnGameplayAbilityEndedWithData äº‹ä»¶ï¼Œå¹¶ç§»é™¤å›è°ƒ</li>
<li>å¯¹äºå®ä¾‹åŒ– Ability è®¾ç½® bIsActive ä¸ºéæ¿€æ´»</li>
<li>ç»“æŸæ‰€æœ‰æŒ‚åœ¨ Ability ä¸Šçš„ GameplayTaskï¼Œå¹¶ Reset åˆ—è¡¨æ¥ç§»é™¤å†…å­˜å ç”¨</li>
<li>å¦‚æœéœ€è¦æ‰§è¡Œ ReplicateEndOrCancelAbility</li>
<li>ç§»é™¤ ActivationTags</li>
<li>ç§»é™¤æŠ€èƒ½æ·»åŠ çš„ GameplayCue</li>
<li>ç§»é™¤ AbilityComponent ä¸Šçš„ Blocking å’Œ Cancel Tags</li>
<li>ç§»é™¤ PK ç¼“å­˜</li>
<li>ç§»é™¤ AbilityComponent ä¸Šçš„ AnimatingAbility</li>
<li>æ’­å‡º AbilityComponent ä¸Šçš„  AbilityEndedCallbacks ï¼Œ OnAbilityEnded äº‹ä»¶</li>
<li>éœ€è¦åŒæ­¥çš„ Ability ï¼Œç§»é™¤ Spec çš„ ReplicatedInstanceï¼ˆæœåŠ¡å™¨ï¼‰</li>
<li>ä¸éœ€è¦åŒæ­¥çš„ Ability ï¼Œç§»é™¤ Spec çš„ NonReplicatedInstances</li>
<li>æœåŠ¡å™¨ä¸Šå¦‚æœæ²¡æœ‰æ´»åŠ¨çš„ Spec åˆ™ï¼Œä¸”è®¾ç½®ä¸ºåœ¨ Activation åå°±ä» Component ä¸­ç§»é™¤ Ability åˆ™ ClearAbilityï¼Œå¦åˆ™ MarkAbilitySpecDirty</li>
</ol>
<p>è¿™é‡Œçš„ ClearAbilityï¼Œå’Œ GiveAbility å¯¹åº”ï¼Œæ˜¯ä» AbilityComponent ä¸­ç§»é™¤è¿™ä¸ª Ability çš„ Handle è€Œ MarkAbilitySpecDirty æ˜¯å¦‚å­—é¢æ„æ€è¡¨ç¤º AbilitySpec å·²ç»è¢«ä¿®æ”¹è¿‡äº†</p>
<h2 id="é…ç½®é¡¹"><a href="#é…ç½®é¡¹" class="headerlink" title="é…ç½®é¡¹"></a>é…ç½®é¡¹</h2><ul>
<li>ReplicationPolicyï¼šåŒæ­¥ç­–ç•¥</li>
<li>InstancingPolicyï¼šå®ä¾‹åŒ–ç­–ç•¥ï¼Œå¯ä»¥è®¾ç½®ä¸ºéå®ä¾‹åŒ–ï¼Œæ¯ä¸ª Actor å®ä¾‹åŒ–ï¼Œæˆ–è€…æ¯æ¬¡æ‰§è¡Œå®ä¾‹åŒ–ï¼Œéå®ä¾‹åŒ–çš„ Ability åªæ˜¯ç”¨å…¶ CDO æ¥åšé€»è¾‘</li>
<li>bServerRespectsRemoteAbilityCancellation ï¼š æ˜¯å¦å¯ä»¥ä»å®¢æˆ·ç«¯æ¥ Cancel æœåŠ¡å™¨ä¸Šçš„ Ability</li>
<li>bRetriggerInstancedAbilityï¼šæ˜¯å¦åœ¨æ¿€æ´»ä¸€ä¸ªå®ä¾‹åŒ–çš„ Ability çš„æ—¶å€™ï¼Œ å…ˆ End å†é‡æ–°æ¿€æ´»</li>
<li>NetExecutionPolicyï¼šç½‘ç»œåŒæ­¥ç­–ç•¥ï¼ŒåŒ…æ‹¬æœ¬åœ°é¢„æµ‹ï¼ŒæœåŠ¡å™¨ only ç­‰</li>
<li>NetSecurityPolicyï¼šç½‘ç»œå®‰å…¨æ”¿ç­–ï¼Œè®¾ç½® Ability çš„æ‰§è¡Œæƒé™</li>
<li>CostGameplayEffectClassï¼šæ¶ˆè´¹çš„ GE</li>
<li>AbilityTriggersï¼šå¯ä»¥æ¿€æ´» Ability çš„ Tags</li>
<li>CooldownGameplayEffectClassï¼šå†·å´çš„ GE</li>
<li>CancelAbilitiesWithTagï¼šæ‰§è¡Œçš„æ—¶å€™ï¼Œä¼š Cancel å«æœ‰è¿™äº› Tag çš„å…¶ä»– Ability</li>
<li>BlockAbilitiesWithTagï¼šæ‰§è¡Œçš„æ—¶å€™ï¼Œä¼š Block å«æœ‰è¿™äº› Tag çš„å…¶ä»– Ability</li>
<li>ActivationOwnedTagsï¼šæ¿€æ´»çš„æ—¶å€™é™„åŠ åˆ° Owner çš„ Tags</li>
<li>ActivationRequiredTagsï¼šæ¿€æ´»çš„æ—¶å€™éœ€è¦çš„ Tags</li>
<li>ActivationBlockedTagsï¼šæ¿€æ´»çš„æ—¶å€™ï¼Œå¦‚æœæœ‰è¿™äº› Tags ä¼šé˜»æ­¢æ¿€æ´»</li>
<li>SourceRequiredTagsï¼šSource Actor æœ‰è¿™äº› Tags çš„æ—¶å€™æ‰èƒ½æ¿€æ´»</li>
<li>SourceBlockedTagsï¼šSource Actor æœ‰è¿™äº› Tags çš„æ—¶å€™ä¸èƒ½æ¿€æ´»</li>
<li>TargetRequiredTagsï¼šTarget Actor æœ‰è¿™äº› Tags çš„æ—¶å€™æ‰èƒ½æ¿€æ´»</li>
<li>TargetBlockedTagsï¼šTarget Actor æœ‰è¿™äº› Tags çš„æ—¶å€™ä¸èƒ½æ¿€æ´»</li>
<li>bReplicateInputDirectly: æ˜¯å¦ç›´æ¥æŠŠè¾“å…¥äº‹ä»¶ä¼ åˆ°æœåŠ¡å™¨</li>
<li>AbilityTagsï¼šæ‹¥æœ‰çš„ Tagsï¼Œä¼šåŒå…¶ä»–çš„ Ability çš„ CancelAbilitiesWithTag å’Œ CancelAbilitiesWithTag ååŒä½œç”¨</li>
</ul>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><ol>
<li>éå®ä¾‹åŒ–çš„ Ability ï¼Œæ€»æ˜¯å¯ä»¥è¢« Cancelï¼Œä¹Ÿæ€»æ˜¯ä¼š Block å…¶ä»–çš„ Abilityï¼Œè€Œä¸éœ€è¦è®¾ç½®</li>
<li>å¯¹äºæ¯ä¸ªå®ä¾‹ä¼šä¸åŒçš„ Abilityï¼Œéœ€è¦è®¾ç½®ä¸ºå®ä¾‹åŒ–ï¼Œå¦åˆ™ä¸è¦è®¾ç½®ä¸ºå®ä¾‹åŒ–ï¼Œä»¥èŠ‚çœèµ„æºï¼ŒAbility æ‰€éœ€çš„å®ä¾‹æ•°æ®äº‹å®ä¸Šå­˜åœ¨ AbilitySpec ä¸­</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mapz.github.io/2021/05/20/UE4%EF%BC%9AC%E7%9B%98%E6%BB%A1%E4%BA%86%EF%BC%8C%E4%BF%AE%E6%94%B9DDC%E7%9B%AE%E5%BD%95%E7%9A%84%E4%BD%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/link-300x300.gif">
      <meta itemprop="name" content="Mapz">
      <meta itemprop="description" content="FIND THE CHILD">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mapz's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/20/UE4%EF%BC%9AC%E7%9B%98%E6%BB%A1%E4%BA%86%EF%BC%8C%E4%BF%AE%E6%94%B9DDC%E7%9B%AE%E5%BD%95%E7%9A%84%E4%BD%8D%E7%BD%AE/" class="post-title-link" itemprop="url">UE4ï¼šCç›˜æ»¡äº†ï¼Œä¿®æ”¹DDCç›®å½•çš„ä½ç½®</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-20 11:09:10" itemprop="dateCreated datePublished" datetime="2021-05-20T11:09:10+08:00">2021-05-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-05-24 10:01:10" itemprop="dateModified" datetime="2021-05-24T10:01:10+08:00">2021-05-24</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ç”µè„‘ä¸Š C ç›˜ç©ºé—´å¤ªå°ï¼Œåªæœ‰ 100 G<br>å…¶ä»–ç›˜çš„ SSD ä¹Ÿä¸å¤Ÿå¤§ï¼Œè™šæ‹Ÿå†…å­˜éƒ½å¿«æ”¾ä¸ä¸‹äº†<br>æ‰“å¼€ WinDirStat ä¸€çœ‹ UE4 DDC å äº†å‡ åä¸ª G äº†<br>è¿™å°±å‡†å¤‡ç§»åŠ¨ä¸€ä¸‹</p>
<ol>
<li>æ‰“å¼€ UE4å®‰è£…ç›®å½•\Engine\Config\BaseEngine.ini</li>
<li>æ‰¾åˆ° InstalledDerivedDataBackendGraph ä¸‹çš„</li>
</ol>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Local</span>=(Type=FileSystem, ReadOnly=<span class="literal">false</span>, Clean=<span class="literal">false</span>, Flush=<span class="literal">false</span>, PurgeTransient=<span class="literal">true</span>, DeleteUnused=<span class="literal">true</span>, UnusedFileAge=<span class="number">34</span>, FoldersToClean=-<span class="number">1</span>, Path=<span class="string">&quot;%ENGINEVERSIONAGNOSTICUSERDIR%DerivedDataCache&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ Path åˆ°è‡ªå·±çš„ç›®å½•å³å¯</p>
<p>å¦‚æœæ²¡æœ‰æˆåŠŸï¼Œå¯ä»¥ä¿®æ”¹ç¯å¢ƒå˜é‡</p>
<p>UE-LocalDataCachePath</p>
<p>å€¼ä¿®æ”¹ä¸ºè‡ªå·±çš„ç›®å½•å³å¯</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mapz.github.io/2021/05/19/UE4%E5%AD%A6%E4%B9%A0%EF%BC%9AFPredictionKey/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/link-300x300.gif">
      <meta itemprop="name" content="Mapz">
      <meta itemprop="description" content="FIND THE CHILD">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mapz's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/19/UE4%E5%AD%A6%E4%B9%A0%EF%BC%9AFPredictionKey/" class="post-title-link" itemprop="url">UE4å­¦ä¹ ï¼šFPredictionKey</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-19 14:38:44" itemprop="dateCreated datePublished" datetime="2021-05-19T14:38:44+08:00">2021-05-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-06-28 11:45:42" itemprop="dateModified" datetime="2021-06-28T11:45:42+08:00">2021-06-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="FPredictionKey-çš„åŸºæœ¬ä¿¡æ¯"><a href="#FPredictionKey-çš„åŸºæœ¬ä¿¡æ¯" class="headerlink" title="FPredictionKey çš„åŸºæœ¬ä¿¡æ¯"></a>FPredictionKey çš„åŸºæœ¬ä¿¡æ¯</h2><p>FPredictionKey æ˜¯ UE4 åœ¨ Gameplay Ability System æ’ä»¶ä¸­æä¾›çš„ä¸€ä¸ªç»“æ„ä½“</p>
<p>ç¼–å†™ç›®çš„æ˜¯ä¸ºäº†åœ¨ GAS ç³»ç»Ÿä¸­å®ç°å®¢æˆ·ç«¯é¢„æµ‹ä»è€Œä¸ç”¨ç­‰å¾…æœåŠ¡å™¨è¿”å›æå‰å°±æå‰åšä¸€äº›æ“ä½œ</p>
<p>è¾¾åˆ°æé«˜æ¸¸æˆæµç•…æ€§çš„ç›®çš„</p>
<p>æœåŠ¡å™¨è¿”å›é€šè¿‡æˆ–è€…æ‹’ç»åï¼Œå®¢æˆ·ç«¯å¯ä»¥ç›¸åº”çš„ Confirm æˆ–è€…åœ¨ Reject åå›æ»šæ­¤æ¬¡æ“ä½œæ‰€åšçš„ä¿®æ”¹</p>
<p>é™¤äº†åœ¨ GAS æœ¬èº«ä¸­</p>
<p>ä½ ä¹Ÿå¯ä»¥åœ¨å…¶ä»–éœ€è¦å®¢æˆ·ç«¯é¢„æµ‹çš„åœ°æ–¹ä½¿ç”¨</p>
<p>ä¾‹å¦‚åŠ¨ç”»çš„é¢„æµ‹</p>
<p>ä½†æ˜¯éœ€è¦ä¾èµ– GAS ä¸­çš„ UAbilitySystemComponent</p>
<ul>
<li>ä¸€ä¸ª Predication Key å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªè¡Œä¸ºåœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„å”¯ä¸€æ ‡è¯†</li>
<li>Predication Key çš„ ID æ˜¯å…¨å±€å”¯ä¸€çš„ï¼Œå‚è€ƒï¼š</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FPredictionKey::GenerateNewPredictionKey</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// GKey ä½œä¸ºé™æ€å±€éƒ¨å˜é‡ï¼Œå…¶å€¼ä¸ºå…¨å±€å”¯ä¸€ï¼Œæ¯æ¬¡éƒ½ ++ </span></span><br><span class="line">    <span class="keyword">static</span> KeyType GKey = <span class="number">1</span>;</span><br><span class="line">    Current = GKey++;</span><br><span class="line">    <span class="keyword">if</span> (GKey &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        GKey = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    bIsStale = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºçš„ PK åˆ™åªä½œä¸ºä¸€ä¸ªè¡Œä¸ºçš„æ ‡è¯†ï¼Œä¸ä½œä¸ºå®¢æˆ·ç«¯é¢„æµ‹ç”¨</p>
</li>
<li><p>PK å¯ä»¥é€šè¿‡ void FPredictionKey::GenerateDependentPredictionKey() åˆ›å»ºä¾èµ–ä¸Šä¸€ä¸ª PK çš„ PK ï¼Œä½†æ˜¯ä¸èƒ½åœ¨æœåŠ¡å™¨æ‰§è¡Œï¼Œå› ä¸ºæ²¡æœ‰æ„ä¹‰ï¼ˆæ— éœ€é¢„æµ‹å°±æ— éœ€ç¡®è®¤å’Œå›æ»šï¼‰</p>
</li>
<li><p>PK å¯ä»¥é€šè¿‡ bIsStale è®¾ç½®ä¸ºæ˜¯å¦å¯ä»¥åœ¨ä¸€æ¬¡ç¡®è®¤æˆ–æ‹’ç»åç»§ç»­ä½¿ç”¨</p>
</li>
<li><p>PK å¯ä»¥é€šè¿‡ NewRejectedDelegate å’Œ NewCaughtUpDelegate æ¥åˆ›å»ºç¡®è®¤æˆ–è€…æ‹’ç»çš„å›è°ƒï¼Œå³æ˜¯æœåŠ¡å™¨åŒæ„æˆ–è€…æ‹’ç»å®¢æˆ·ç«¯é¢„æµ‹çš„æ—¶å€™æ‰€è°ƒç”¨çš„å›è°ƒ</p>
</li>
<li><p>PK çš„ç½‘ç»œåºåˆ—åŒ–æ˜¯è‡ªå®šä¹‰çš„</p>
<ul>
<li>ç¬¬ä¸€ä½æ˜¯ PK æ˜¯å¦åœ¨å½“å‰ Connection å¯ç”¨ï¼Œåœ¨åºåˆ—åŒ–çš„æ—¶å€™è®¾ç½®ï¼Œå¦‚æœæ˜¯æœåŠ¡å™¨åˆ›å»ºçš„ï¼Œåˆ™éƒ½å¯ç”¨ï¼Œå¦åˆ™åªæœ‰ PK çš„è¿æ¥ä¿¡æ¯å’Œå½“å‰è¿æ¥ä¸€è‡´çš„æ—¶å€™å¯ç”¨<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ValidKeyForConnection = (PredictiveConnection == <span class="literal">nullptr</span> || (Map == PredictiveConnection) || bIsServerInitiated) &amp;&amp; (Current &gt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure></li>
<li>ç¬¬äºŒä½æ˜¯æ˜¯å¦æœ‰ä¾èµ–çš„ PK ï¼ˆä»…å½“å½“å‰ Connection å¯ç”¨çš„æ—¶å€™å¯ç”¨ï¼‰</li>
<li>ç¬¬ä¸‰ä½æ˜¯æ˜¯å¦ä¸ºæœåŠ¡å™¨åˆ›å»º</li>
<li>å¦‚æœæ˜¯å¯ç”¨è¿æ¥ï¼Œåˆ™å†™å…¥å½“å‰çš„ PK ID</li>
<li>å¦‚æœæœ‰ä¾èµ–çš„ PK åˆ™å†™å…¥ä¾èµ– PK ID</li>
<li>å¦‚æœæ˜¯æœåŠ¡å™¨åˆ›å»ºçš„ PK åˆ™è®¾ç½®å½“å‰ PK çš„ Connection ä¸ºå½“å‰ Connection</li>
</ul>
</li>
</ul>
<h2 id="ä»-Activate-Ability-æ¥çœ‹-PredicationKey-çš„ä½¿ç”¨"><a href="#ä»-Activate-Ability-æ¥çœ‹-PredicationKey-çš„ä½¿ç”¨" class="headerlink" title="ä» Activate Ability æ¥çœ‹ PredicationKey çš„ä½¿ç”¨"></a>ä» Activate Ability æ¥çœ‹ PredicationKey çš„ä½¿ç”¨</h2><p>æˆ‘ä»¬ä» UAbilitySystemCompoment::TryActivateAbility çœ‹èµ·ï¼Œè¿™é‡Œä»…è®¨è®ºä¸€ç§æƒ…å†µï¼Œå°±æ˜¯å®¢æˆ·ç«¯å‘èµ·æ¿€æ´»ï¼ŒæœåŠ¡å™¨æ£€æŸ¥å¹¶ç¡®è®¤çš„æ–¹å¼ï¼Œç•¥è¿‡å…¶ä»–æ–¹å¼çš„æµç¨‹</p>
<ol>
<li>å…ˆåˆ¤æ–­æŠ€èƒ½æ˜¯å¦å¯ä»¥è¢«é‡Šæ”¾ï¼ˆæ˜¯å¦å·²ç»è¢« Give To Actorï¼‰</li>
<li>åˆ¤æ–­æŠ€èƒ½é‡Šæ”¾çš„ Actor æ˜¯å¦åˆæ³•</li>
<li>æ¨¡æ‹Ÿç«¯ä¸å¯ä»¥é‡Šæ”¾æŠ€èƒ½ï¼Œreturn</li>
<li>æ£€æŸ¥æŠ€èƒ½æ˜¯å¦æ˜¯å®¢æˆ·ç«¯è¿œç¨‹é‡Šæ”¾çš„ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦å¯ä»¥è¿œç¨‹é‡Šæ”¾ï¼Œå¦‚æœå¯ä»¥é‡Šæ”¾åˆ™ åˆ›å»ºæ–°çš„ PK å¹¶è°ƒç”¨ CallServerTryActivateAbility å‡†å¤‡æ‰§è¡ŒæœåŠ¡å™¨ RPC ServerTryActivateAbility</li>
<li>CallServerTryActivateAbility ä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨åˆæ‰¹çš„ RPC æ•°æ®ï¼Œå¦‚æœåˆæ‰¹çš„ RPC æ•°æ®æœªå¼€å§‹ï¼Œåˆ™æ›´æ–° PK å¹¶å¼€å§‹ï¼Œå¦åˆ™ç›´æ¥è°ƒç”¨ æœåŠ¡å™¨ RPC ServerTryActivateAbility ï¼Œå¹¶ä¼ å…¥åˆ›å»ºçš„ PK</li>
<li>Server è°ƒç”¨ InternalServerTryActivateAbility<br> a. Activate å¤±è´¥çš„æ—¶å€™ï¼Œè°ƒç”¨å®¢æˆ·ç«¯ RPC ï¼Œé€šçŸ¥æ­¤ PK è°ƒç”¨å¤±è´¥ï¼Œå®¢æˆ·ç«¯è°ƒç”¨æ­¤ PK çš„æ‹’ç»å§”æ‰˜ï¼Œä»è€Œè¾¾åˆ°å›æ»šç­‰ç›®çš„ï¼Œå¹¶ä¸”æ‰§è¡Œ EndAbility<br> b. Activate æˆåŠŸçš„æ—¶å€™ï¼Œè°ƒç”¨å®¢æˆ·ç«¯ RPC ClientActivateAbilitySucceed é€šçŸ¥å®¢æˆ·ç«¯æ¿€æ´» Ability æˆåŠŸ<br> c. å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ¨æˆåŠŸçš„æ—¶å€™ï¼Œéƒ½ä¼šè°ƒç”¨ CallActivateAbility æ¥å¯åŠ¨ Activate Ability</li>
</ol>
<p>è¿™ä¸ªé‡Œé¢ï¼Œä¸€ä¸ª PredicationKey  é€šè¿‡ RPC åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ é€’å¹¶å‚¨å­˜ï¼Œå¹¶ä¸”é€šè¿‡ RPC é€šçŸ¥æ‰§è¡ŒæˆåŠŸæˆ–è€…å¤±è´¥ï¼Œåœ¨æˆåŠŸå’Œå¤±è´¥çš„æ—¶å€™ï¼Œæ‰§è¡Œé€šè¿‡ PK å¯¹åº”èµ·æ¥çš„æˆåŠŸå’Œå¤±è´¥çš„å§”æ‰˜</p>
<p>Activate Ability å¹¶æ²¡æœ‰ç›´æ¥ç”¨åˆ°å›æ»šç›¸å…³çš„å†…å®¹ï¼Œå› ä¸ºè¿™é‡Œæ²¡æœ‰åœ¨å®¢æˆ·ç«¯ Try Activate Ability ååšå…¶ä»–æ“ä½œï¼Œè€Œæ˜¯ç­‰å¾…æœåŠ¡å™¨è¿”å› Confirm æˆ–è€… Reject</p>
<p>æˆ‘ä»¬åœ¨é‡Šæ”¾æŠ€èƒ½åï¼Œä¹Ÿå¯ä»¥ä¼šåšè¿‡ä¸€äº›é™„åŠ æ“ä½œï¼Œè¿™äº›æ“ä½œå¯ä»¥åœ¨ Reject å§”æ‰˜ä¸­ç»‘å®šè‡ªå·±çš„å›æ»šæ“ä½œ</p>
<p>å†™å…¶ä»–ä¸€äº›åŠŸèƒ½çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨å®¢æˆ·ç«¯å‘é€ RPC åï¼Œç›´æ¥å¼€å§‹å¤„ç†è‡ªå·±çš„æ“ä½œï¼Œç­‰å¾…æœåŠ¡å™¨ Reject åï¼Œç”¨æŒ‚åœ¨ Reject çš„å§”æ‰˜ä¸Šï¼Œç”¨äºå›æ»šå®¢æˆ·ç«¯æ“ä½œï¼Œä¾‹å¦‚åœæ­¢æ’­æ”¾åŠ¨ç”»</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mapz.github.io/2021/05/17/UE4%EF%BC%9A%E6%B8%B8%E6%88%8F%E5%85%B3%E9%97%AD%E6%B5%81%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/link-300x300.gif">
      <meta itemprop="name" content="Mapz">
      <meta itemprop="description" content="FIND THE CHILD">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mapz's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/17/UE4%EF%BC%9A%E6%B8%B8%E6%88%8F%E5%85%B3%E9%97%AD%E6%B5%81%E7%A8%8B/" class="post-title-link" itemprop="url">UE4ï¼šæ¸¸æˆå…³é—­æµç¨‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-17 16:00:58" itemprop="dateCreated datePublished" datetime="2021-05-17T16:00:58+08:00">2021-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-05-25 11:15:51" itemprop="dateModified" datetime="2021-05-25T11:15:51+08:00">2021-05-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨ UE4 å…³é—­æ¸¸æˆçš„æ—¶å€™ï¼Œå¤„ç†ä¸€äº›äº‹æƒ…ï¼Œé‚£ä¹ˆå¯ä»¥é‡å†™ UGameInstance::ShutDown()</p>
<p>ä½†æ˜¯æœ‰æ—¶å€™åœ¨æ¸¸æˆå…³é—­çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å¹¶æœªè°ƒç”¨ï¼Œäºæ˜¯æˆ‘æœ‰å¿…è¦æ¢ç©¶ä¸€ç•ªä»–çš„è°ƒç”¨é“¾</p>
<p>è¿™é‡Œä»…è®¨è®º Engine è€Œä¸è®¨è®º EditorEngine</p>
<p>è°ƒç”¨æ ˆ</p>
<ul>
<li>UGameInstance::ShutDown()</li>
<li>UGameEngine::PreExit()</li>
<li>FEngineLoop::Exit()</li>
<li>è°ƒç”¨ EngineExit æˆ–è€…å¹³å°è°ƒç”¨é€€å‡º</li>
<li>EngineExit è¢«æ”¾åœ¨äº† GuardedMain å‡½æ•°ä¸­å®šä¹‰çš„ä¸€ä¸ªç»“æ„ä½“ä¸­</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">// make sure GEngineLoop::Exit() is always called.</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EngineLoopCleanupGuard</span> </span></span><br><span class="line"><span class="class">&#123;</span> </span><br><span class="line">	~<span class="built_in">EngineLoopCleanupGuard</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">EngineExit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125; CleanupGuard;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´æ¸¸æˆ Main å‡½æ•°ç»“æŸæ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€å®šä¼šæ‰§è¡Œ ShutDown</p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘æµ‹è¯•çš„æ—¶å€™æ—¥å¿—ä¸­æ²¡æœ‰å‡ºç° ShutDown ç›¸å…³å†…å®¹å‘¢</p>
<p>æ£€æŸ¥å‘ç°æˆ‘ä»¬è°ƒç”¨å…³é—­æ¸¸æˆçš„æ—¶å€™ç”¨çš„æ˜¯</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FPlatformMisc::<span class="built_in">RequestExit</span>(<span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FWindowsPlatformMisc::RequestExit</span><span class="params">( <span class="keyword">bool</span> Force )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">UE_LOG</span>(LogWindows, Log,  <span class="built_in">TEXT</span>(<span class="string">&quot;FPlatformMisc::RequestExit(%i)&quot;</span>), Force );</span><br><span class="line"></span><br><span class="line">	<span class="built_in">RequestEngineExit</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;Win RequestExit&quot;</span>));</span><br><span class="line">	FCoreDelegates::ApplicationWillTerminateDelegate.<span class="built_in">Broadcast</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( Force )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// Force immediate exit. In case of an error set the exit code to 3.</span></span><br><span class="line">		<span class="comment">// Dangerous because config code isn&#x27;t flushed, global destructors aren&#x27;t called, etc.</span></span><br><span class="line">		<span class="comment">// Suppress abort message and MS reports.</span></span><br><span class="line">		<span class="comment">//_set_abort_behavior( 0, _WRITE_ABORT_MSG | _CALL_REPORTFAULT );</span></span><br><span class="line">		<span class="comment">//abort();</span></span><br><span class="line">	</span><br><span class="line">		<span class="comment">// Make sure the log is flushed.</span></span><br><span class="line">		<span class="keyword">if</span>( GLog )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// This may be called from other thread, so set this thread as the master.</span></span><br><span class="line">			GLog-&gt;<span class="built_in">SetCurrentThreadAsMasterThread</span>();</span><br><span class="line">			GLog-&gt;<span class="built_in">TearDown</span>();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">TerminateProcess</span>(<span class="built_in">GetCurrentProcess</span>(), GIsCriticalError ? <span class="number">3</span> : <span class="number">0</span>); </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// Tell the platform specific code we want to exit cleanly from the main loop.</span></span><br><span class="line">		<span class="built_in">PostQuitMessage</span>( <span class="number">0</span> );</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯è§ä¼ å…¥ true ä¸ºå‚æ•°çš„æ—¶å€™ï¼Œç›´æ¥æŠŠè¿›ç¨‹æ€äº†ï¼Œå¯¼è‡´æœªæ‰§è¡Œ UGameInstance::ShutDown()</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mapz.github.io/2019/01/17/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%83%8F%E7%B4%A0FC%E8%BF%98%E5%8E%9F%E6%B8%B8%E6%88%8FSuperSimon%EF%BC%88%E4%B8%80%EF%BC%89%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/link-300x300.gif">
      <meta itemprop="name" content="Mapz">
      <meta itemprop="description" content="FIND THE CHILD">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mapz's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/17/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%83%8F%E7%B4%A0FC%E8%BF%98%E5%8E%9F%E6%B8%B8%E6%88%8FSuperSimon%EF%BC%88%E4%B8%80%EF%BC%89%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C/" class="post-title-link" itemprop="url">Unityå­¦ä¹ ï¼šåƒç´ FCè¿˜åŸæ¸¸æˆSuperSimonï¼ˆä¸€ï¼‰å‡†å¤‡å·¥ä½œ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-17 16:44:09" itemprop="dateCreated datePublished" datetime="2019-01-17T16:44:09+08:00">2019-01-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-22 10:15:32" itemprop="dateModified" datetime="2021-04-22T10:15:32+08:00">2021-04-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç°åœ¨å¼€å§‹æ­£å¼åˆ¶ä½œæˆ‘ä»¬çš„FCé‡åˆ¶æ¸¸æˆ SuperSimon</p>
<h2 id="åˆ›å»ºç¯å¢ƒ"><a href="#åˆ›å»ºç¯å¢ƒ" class="headerlink" title="åˆ›å»ºç¯å¢ƒ"></a>åˆ›å»ºç¯å¢ƒ</h2><ol>
<li>Unity 2018.3</li>
<li>ä½¿ç”¨ Package Manager ä¸‹è½½ 2D Pixel Perfect æ’ä»¶ï¼ˆéœ€è¦è®¾ç½® Package Manager çš„é«˜çº§è®¾ç½®ï¼Œæ‰“å¼€æ˜¾ç¤ºé¢„è§ˆåŒ…</li>
<li>å› ä¸ºæœ¬æ¬¡ä½¿ç”¨æ–°çš„è¾“å…¥åŒ…ï¼Œä½¿ç”¨ Package Manager ä¸‹è½½ Input System</li>
<li>ä½¿ç”¨ <a href="https://mapz.github.io/2019/01/17/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AFC%E4%B8%AD%E6%8A%A0%E5%87%BA%E6%9D%A5%E7%9A%84%E5%AD%97%E4%BD%93%E5%81%9A%E6%88%90BitmapFont/">è¿™é‡Œ</a> çš„æ–‡ç« ä¸­çš„æ–¹å¼ï¼Œä»æ¶é­”åŸ3çš„SpriteSheetä¸­åˆ›å»ºå¥½å­—ä½“</li>
</ol>
<img src="/2019/01/17/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%83%8F%E7%B4%A0FC%E8%BF%98%E5%8E%9F%E6%B8%B8%E6%88%8FSuperSimon%EF%BC%88%E4%B8%80%EF%BC%89%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C/CV3Font.png" class="" title="Dumpçš„å­—ä½“å›¾ç‰‡">

<h2 id="åœºæ™¯ä¸­çš„å†…å®¹"><a href="#åœºæ™¯ä¸­çš„å†…å®¹" class="headerlink" title="åœºæ™¯ä¸­çš„å†…å®¹"></a>åœºæ™¯ä¸­çš„å†…å®¹</h2><ol>
<li>æ‘„åƒæœºè®¾ç½®æ­£äº¤ï¼ŒèƒŒæ™¯è‰² solid color,å¤§å°128</li>
<li>æ‘„åƒæœºGOä¸Šæ·»åŠ ä¸€ä¸ª Pixel Perfect Cameraï¼Œè®¾ç½®pixel perUnit 1,åˆ†è¾¨ç‡256 x 240,ä¸‹é¢é’©å­å…¨æ‰“ä¸Š</li>
<li>åˆ›å»ºUICanvasï¼Œç”¨æ‘„åƒæœº Renderï¼ŒPixel perfect å‹¾ä¸Šï¼ŒCanvas Scaler åˆ†è¾¨ç‡è®¾ç½®å¥½ï¼Œæ¨¡å¼é€‰æ‹©éšå±å¹•å¤§å°ç¼©æ”¾ã€‚ pixel per unit 1ã€‚Match mode expandã€‚</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mapz.github.io/2019/01/17/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AFC%E4%B8%AD%E6%8A%A0%E5%87%BA%E6%9D%A5%E7%9A%84%E5%AD%97%E4%BD%93%E5%81%9A%E6%88%90BitmapFont/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/link-300x300.gif">
      <meta itemprop="name" content="Mapz">
      <meta itemprop="description" content="FIND THE CHILD">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mapz's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/17/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AFC%E4%B8%AD%E6%8A%A0%E5%87%BA%E6%9D%A5%E7%9A%84%E5%AD%97%E4%BD%93%E5%81%9A%E6%88%90BitmapFont/" class="post-title-link" itemprop="url">Unityå­¦ä¹ ï¼šFCä¸­æŠ å‡ºæ¥çš„å­—ä½“åšæˆBitmapFont</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-17 16:12:22" itemprop="dateCreated datePublished" datetime="2019-01-17T16:12:22+08:00">2019-01-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-22 10:15:32" itemprop="dateModified" datetime="2021-04-22T10:15:32+08:00">2021-04-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>åšåƒç´ æ¸¸æˆçš„æ—¶å€™ï¼Œä½ é€šå¸¸ä¼šè‡ªå®šä¹‰å­—ä½“ï¼Œæˆ–è€…ç»˜åˆ¶åƒç´ å­—ä½“ã€‚</p>
<p>å­—ä½“ç”»å¥½ï¼Œæˆ–è€…åƒæˆ‘ä»¬ä¸€æ ·ç›´æ¥ä» FC æ¸¸æˆé‡Œé¢æŠ å‡ºå›¾é›†æ¥ä¹‹åï¼Œæ€ä¹ˆæ ·æ¥åšæˆBitmapFontå‘¢ï¼Ÿ</p>
<p>ç½‘ä¸Šçš„å†…å®¹é€šå¸¸æ•™ä½ æ€ä¹ˆä»å®‰è£…å¥½çš„ttfæ¥å¯¼å‡ºï¼Œç°åœ¨æˆ‘ä»¬æ‰‹ä¸Šåªæœ‰ PNG æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<h2 id="ç”¨åˆ°çš„å·¥å…·"><a href="#ç”¨åˆ°çš„å·¥å…·" class="headerlink" title="ç”¨åˆ°çš„å·¥å…·"></a>ç”¨åˆ°çš„å·¥å…·</h2><ul>
<li>BMFont</li>
<li>Unity</li>
</ul>
<h2 id="å‡è®¾"><a href="#å‡è®¾" class="headerlink" title="å‡è®¾"></a>å‡è®¾</h2><ol>
<li>æˆ‘ä»¬çš„å­—ç¬¦å›¾é›†ä¸­æ–‡å­—å¤§å°éƒ½æ˜¯ 8 X 8,å¹¶ä¸”æ— é—´éš”ï¼ˆä¹Ÿå¯ä»¥æ˜¯å…¶ä»–å¤§å°ï¼Œæ€»ä¹‹Unityå¯ä»¥è‡ªåŠ¨æŒ‰æ ¼å­å¤§å°æ¥åˆ‡å°±è¡Œï¼‰</li>
</ol>
<h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol>
<li>æˆ‘ä»¬ä»FC Dump ä¸‹æ¥çš„å­—ä½“å›¾é›†ï¼Œä¸€èˆ¬éƒ½æ˜¯8x8çš„å­—ç¬¦é›†ï¼Œä¸ºäº†èƒ½å¤Ÿä½¿ç”¨BMFontæ¥å¯¼å‡ºBitmap Fontï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŠŠè¿™ä¸ªå›¾é›†æ‰“æˆå•ä¸ªçš„å­—ç¬¦ã€‚</li>
<li>æ‰“å¼€ Unityï¼Œå¯¼å…¥å­—ç¬¦é›†å›¾ç‰‡ï¼Œå¯¼å…¥è®¾ç½®ä¸º å‹ç¼©-&gt;æ— ï¼Œå¹¶æŠŠå¯è¯»å†™æ‰“å¼€ï¼ŒSpriteç±»å‹ä¸ºå¤šä¸ª</li>
<li>æ‰“å¼€ Sprite Editor ï¼Œåˆ‡ç‰‡æ–¹å¼ By Cell Size å¤§å° 8 x 8ï¼Œåˆ‡å¥½å›¾é›†</li>
<li>ä½¿ç”¨å¦‚ä¸‹è„šæœ¬å¯¼å‡ºä¸ºå•ä¸ªçš„å›¾ç‰‡</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">using UnityEditor;</span><br><span class="line">using UnityEngine;</span><br><span class="line">static class BitmapFontTool &#123;</span><br><span class="line">    [MenuItem (&quot;BitmapFontTool/å¯¼å‡ºåˆ‡å¥½çš„Sprite&quot;)]</span><br><span class="line">    static void SaveSprite () &#123;</span><br><span class="line">        //æ¯ä¸€å¼ è´´å›¾ç±»å‹Advancedä¸‹ Read/Write Enabledæ‰“ä¸Šå‹¾æ‰èƒ½è¿›è¡Œæ–‡ä»¶è¯»å–</span><br><span class="line">        //å¯¼å…¥ç±»å‹ä¸èƒ½æ˜¯å‹ç¼©è¿‡çš„</span><br><span class="line">        string bitMapfontPath = @&quot;Assets/BitmapFontTool/&quot;;</span><br><span class="line">        foreach (Object obj in Selection.objects) &#123;</span><br><span class="line"></span><br><span class="line">            string selectionPath = AssetDatabase.GetAssetPath (obj);</span><br><span class="line">            string selectionExt = System.IO.Path.GetExtension (selectionPath);</span><br><span class="line">            string fileName = System.IO.Path.GetFileNameWithoutExtension (selectionPath);</span><br><span class="line">            string loadPath = selectionPath.Substring (0, selectionPath.Length - selectionExt.Length);</span><br><span class="line">            if (selectionExt.Length == 0) continue;</span><br><span class="line"></span><br><span class="line">            //åŠ è½½æ­¤æ–‡ä»¶ä¸‹çš„æ‰€æœ‰èµ„æº</span><br><span class="line">            Object[] spriteList = AssetDatabase.LoadAllAssetsAtPath (selectionPath); </span><br><span class="line"></span><br><span class="line">            if (spriteList.Length &gt; 0) &#123;</span><br><span class="line">                //åˆ›å»ºå¯¼å‡ºæ–‡ä»¶å¤¹</span><br><span class="line">                string outPath = bitMapfontPath + &quot;/SpriteExportOutput/&quot; + fileName;</span><br><span class="line">                System.IO.Directory.CreateDirectory (outPath);</span><br><span class="line"></span><br><span class="line">                foreach (var sprite in spriteList) &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        var sprite_ = (Sprite) sprite;</span><br><span class="line">                        Texture2D tex = new Texture2D ((int) sprite_.rect.width, (int) sprite_.rect.height, sprite_.texture.format, false);</span><br><span class="line">                        tex.SetPixels (sprite_.texture.GetPixels ((int) sprite_.rect.xMin, (int) sprite_.rect.yMin, (int) sprite_.rect.width, (int) sprite_.rect.height));</span><br><span class="line">                        tex.Apply ();</span><br><span class="line">                        //å†™å‡ºæˆpngæ–‡ä»¶</span><br><span class="line">                        System.IO.File.WriteAllBytes (outPath + &quot;/&quot; + sprite_.name + &quot;.png&quot;, tex.EncodeToPNG ());</span><br><span class="line">                        Debug.Log (&quot;SaveSprite to&quot; + outPath);</span><br><span class="line">                    &#125; catch (System.Exception e) &#123;</span><br><span class="line">                        Debug.Log (e);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                Debug.Log (&quot;ä¿å­˜å›¾ç‰‡å®Œæ¯•!&quot; + outPath);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        // &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>ç½‘ä¸Šæœç´¢ BMFont æ•™ç¨‹ï¼ŒæŒ‰æ•™ç¨‹ä½¿ç”¨å¯¼å‡ºçš„å›¾ç‰‡ï¼Œåˆ›å»º fnt å­—ä½“</li>
<li>æŠŠè¾“å‡ºçš„æ–‡ä»¶å¯¼å…¥ Unity ,ä¸‹è½½ BitmapFontImporter æ’ä»¶</li>
<li>Assets -&gt; Bitmap Font -&gt; build åˆ›å»º Unity è‡ªå®šä¹‰å­—ä½“</li>
<li>ä½¿ç”¨å­—ä½“</li>
</ol>
<h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><ol>
<li>BMFont å¯¼å…¥å¤§é‡å›¾ç‰‡æ–‡ä»¶çš„æ—¶å€™éå¸¸çš„éš¾ç”¨ï¼Œä¸é€‚åˆæ‰¹é‡ä½¿ç”¨</li>
<li>æ—¢ç„¶å·²ç»æœ‰å›¾é›†äº†ï¼Œä½•ä¸åœ¨å›¾é›†ä¸Šè‡ªå·±åˆ›å»ºfntæ–‡ä»¶å‘¢ï¼Ÿ</li>
</ol>
<h2 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>åœ¨Unityä¸‹ï¼Œè‡ªå·±å†™ä¸ªå·¥å…·æ¥åˆ¶ä½œfntä¹Ÿå¹¶ä¸éš¾<br>æŒ–ä¸ªå‘ç•™ç€ä»¥åæ¥å°è¯•</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mapz.github.io/2019/01/17/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%BC%80%E6%96%B0%E5%9D%91%EF%BC%8CSuper-Simon-Adv/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/link-300x300.gif">
      <meta itemprop="name" content="Mapz">
      <meta itemprop="description" content="FIND THE CHILD">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mapz's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/17/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%BC%80%E6%96%B0%E5%9D%91%EF%BC%8CSuper-Simon-Adv/" class="post-title-link" itemprop="url">Unityå­¦ä¹ ï¼šå¼€æ–°å‘ï¼ŒSuper_Simon_Adv</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-17 11:00:16" itemprop="dateCreated datePublished" datetime="2019-01-17T11:00:16+08:00">2019-01-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-22 10:15:32" itemprop="dateModified" datetime="2021-04-22T10:15:32+08:00">2021-04-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä¹‹å‰åšäº† FC è’é‡å¤§é•–å®¢çš„ retro demo</p>
<p>æ€»ç»“äº†ä¸€äº›é—®é¢˜ï¼Œç°åœ¨å‡†å¤‡å…ˆæ”¾åœ¨ä¸€è¾¹ï¼Œä¸æƒ³æ”¹äº†</p>
<p>æ ¹æ®æ€»ç»“çš„è¿™äº›é—®é¢˜ï¼Œå¼€ä¸ªæ–°å‘å§</p>
<p>å‡†å¤‡å¼„æˆä¸€ä¸ª FC å¤§æ‚çƒ©æ¸¸æˆ</p>
<h2 id="å†…å®¹"><a href="#å†…å®¹" class="headerlink" title="å†…å®¹"></a>å†…å®¹</h2><p>æ¶é­”åŸè¥¿è’™çš„å¤§å†’é™©</p>
<p>ç´ æä¸ºå„ä¸ª FC æ¸¸æˆå†…å®¹</p>
<p>æ¨ªç‰ˆ Platform<br>æ ¹æ®å¯èƒ½ ä¹Ÿä¼šå˜æˆ æ¨ªç‰ˆæ¸…å…³</p>
<h2 id="åˆ†è¾¨ç‡"><a href="#åˆ†è¾¨ç‡" class="headerlink" title="åˆ†è¾¨ç‡"></a>åˆ†è¾¨ç‡</h2><p>è¿˜åŸ FC çš„ 256 X 240 åˆ†è¾¨ç‡</p>
<h2 id="é¢„è®¡ç”¨åˆ°çš„å†…å®¹å’Œæ”¹è¿›"><a href="#é¢„è®¡ç”¨åˆ°çš„å†…å®¹å’Œæ”¹è¿›" class="headerlink" title="é¢„è®¡ç”¨åˆ°çš„å†…å®¹å’Œæ”¹è¿›"></a>é¢„è®¡ç”¨åˆ°çš„å†…å®¹å’Œæ”¹è¿›</h2><ol>
<li>ä¹‹å‰çš„ Demo æ²¡æœ‰ç»è¿‡è®¾è®¡ï¼Œæƒ³åˆ°å“ªå†™åˆ°å“ªï¼Œå¤ªæ½¦è‰ï¼Œæ‰€ä»¥è¿™æ¬¡å…ˆè®¾è®¡å¥½å†å‡ºå‘</li>
<li>è¿™æ¬¡ä½¿ç”¨ CSV çš„æ–¹å¼æ¥é…ç½®å•ä½å±æ€§ï¼Œå¹¶åˆå§‹åŒ–</li>
<li>Pixel Perfect æ‘„åƒæœº</li>
<li>å…ˆå¼„æˆå•æœºæ‰“åŒ…æ¨¡å¼ï¼ŒåæœŸå†å¼„æˆå¯çƒ­æ›´æ–°æ¨¡å¼</li>
<li>å…ˆæœŸæ¥å…¥ Lua</li>
<li>ä½¿ç”¨ Unity çš„ Preview æ–°è¾“å…¥æ–¹å¼</li>
<li>AI ä½¿ç”¨ è¡Œä¸ºæ ‘</li>
<li>ä½¿ç”¨ä¸€äº› Shader æ¥åˆ¶ä½œæ•ˆæœ</li>
<li>ç”Ÿæ€ªå™¨çš„è¿›ä¸€æ­¥ä¼˜åŒ–</li>
<li>åšä¸€ä¸ªä» PNG å¯¼å‡º Bitmap Font çš„å·¥å…·</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mapz.github.io/2018/12/11/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AProjectTiny%E7%8E%B0%E7%8A%B6%EF%BC%88%E5%8D%B3%E6%97%B6%E6%9B%B4%E6%96%B0%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/link-300x300.gif">
      <meta itemprop="name" content="Mapz">
      <meta itemprop="description" content="FIND THE CHILD">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mapz's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/11/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AProjectTiny%E7%8E%B0%E7%8A%B6%EF%BC%88%E5%8D%B3%E6%97%B6%E6%9B%B4%E6%96%B0%EF%BC%89/" class="post-title-link" itemprop="url">Unityå­¦ä¹ ï¼šProjectTinyç°çŠ¶ï¼ˆå³æ—¶æ›´æ–°ï¼‰</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-12-11 15:33:34" itemprop="dateCreated datePublished" datetime="2018-12-11T15:33:34+08:00">2018-12-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-22 10:15:32" itemprop="dateModified" datetime="2021-04-22T10:15:32+08:00">2021-04-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="TileMap"><a href="#TileMap" class="headerlink" title="TileMap"></a>TileMap</h2><ul>
<li>å¯ä»¥ç¼–è¾‘ï¼Œå¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯ç°åœ¨æ— ç‰©ç†ç‰¹æ€§ï¼ˆPlatformæ¸¸æˆå¯ä»¥å…ˆç­‰ç­‰ï¼‰ï¼Œä¸èƒ½è®¾ç½®ç¢°æ’</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mapz.github.io/2018/12/10/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AProjectTiny%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%E5%BC%B9%E7%90%83%E5%92%8C2D%E7%89%A9%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/link-300x300.gif">
      <meta itemprop="name" content="Mapz">
      <meta itemprop="description" content="FIND THE CHILD">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mapz's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/10/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AProjectTiny%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%E5%BC%B9%E7%90%83%E5%92%8C2D%E7%89%A9%E7%90%86/" class="post-title-link" itemprop="url">Unityå­¦ä¹ ï¼šProjectTinyå­¦ä¹ ï¼ˆäºŒï¼‰å¼¹çƒå’Œ2Dç‰©ç†</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-12-10 14:40:38" itemprop="dateCreated datePublished" datetime="2018-12-10T14:40:38+08:00">2018-12-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-23 18:01:14" itemprop="dateModified" datetime="2021-04-23T18:01:14+08:00">2021-04-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æ¥ç€ä¸Šæ¬¡æˆ‘ä»¬ç»§ç»­æ¥ç© Tiny Mode</p>
<h2 id="åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®"><a href="#åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®" class="headerlink" title="åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®"></a>åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®</h2><p>èœå• -&gt; tiny -&gt; file -&gt; new project </p>
<p>åˆ›å»ºæ–°çš„é¡¹ç›® TinyNew</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ Asset ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„åä¸º TinyNew çš„ç›®å½•</p>
<p>ä¸‹é¢æœ‰ä¸€ä¸ª TinyNew.utproject æ–‡ä»¶</p>
<p>è¿™ä¸ªæ–‡ä»¶å°±æ˜¯ tiny mode çš„é¡¹ç›®æ–‡ä»¶äº†</p>
<p>å’Œ Unity ä¸åŒï¼Œtiny mode ä¸å­˜åœ¨ Scene </p>
<p>åŒå‡»é¡¹ç›®æ–‡ä»¶ï¼Œå°±å¯ä»¥åŠ è½½é¡¹ç›®äº†</p>
<p>é¡¹ç›®çš„ Inspector å¦‚å›¾</p>


<p>å¯ä»¥é€‰æ‹© Build ç±»å‹ï¼Œéœ€è¦åŠ è½½çš„æ¨¡å—</p>
<p>è¿˜æœ‰æ˜¾ç¤ºè®¾ç½®ä»¥åŠç‰©ç†è®¾ç½®</p>
<p>ä»å¯åŠ è½½çš„æ¨¡å—çœ‹æˆ‘ä»¬ç°åœ¨åŸºæœ¬ä¹Ÿå¯ä»¥çŸ¥é“ Tiny Mode ç°æœ‰çš„åŠŸèƒ½æœ‰å“ªäº›</p>
<p>ç‰©ç†é€‰é¡¹åªæœ‰ä¸€ä¸ªé‡åŠ›ï¼Œå¯ä»¥çœ‹å‡ºç›¸æ¯” Unity æœ¬ä½“éå¸¸çš„ç²¾ç®€</p>
<p>æˆ‘ä»¬è¦åšçš„æ˜¯å¹³é¢ä¸Šçƒè§¦è¾¹å¼¹çš„æ•ˆæœï¼Œæ‰€ä»¥é‡åŠ›è®¾ç½®ä¸º 0</p>
<hr>
<h2 id="å¼€å§‹åˆ›å»ºä¸»å®ä½“"><a href="#å¼€å§‹åˆ›å»ºä¸»å®ä½“" class="headerlink" title="å¼€å§‹åˆ›å»ºä¸»å®ä½“"></a>å¼€å§‹åˆ›å»ºä¸»å®ä½“</h2><p>ä»¥å‰æˆ‘ä»¬çš„å„ç§ç©æ„ï¼Œéƒ½æ˜¯æ”¾åœ¨ GameObject ä¸Šçš„ï¼Œåœ¨ ECS ä¸­ï¼ŒGameObject æ²¡æœ‰äº†ï¼Œç”¨æ¥æ”¾å†…å®¹çš„å˜æˆäº† Entityï¼Œæ‰€ä»¥è¿˜æ˜¯è€ä¸€å¥—ï¼Œéœ€è¦ä¸€ä¸ª Entity æ¥æ”¾ç½®æ‘„åƒæœºä»€ä¹ˆçš„</p>
<p>åˆ›å»ºä¸€ä¸ªæ–°çš„ Entity ç°é˜¶æ®µåªèƒ½ä» Tiny èœå• Create EntityGroup æˆ–è€…å±‚çº§å›¾ä¸­ï¼Œç‚¹å‡» Create EntityGroup</p>
<p>æˆ‘ä»¬åœ¨ Entities ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª MainGroupï¼Œç‚¹å‡»å</p>
<p>åœ¨ EntityGroup çš„ Inspector ä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæŒ‰é’®</p>


<ul>
<li>Load: åŠ è½½è¿™ä¸ªç»„çš„ä¸€ä¸ª Entity å®ä¾‹åˆ°å±‚çº§å›¾ä¸­ï¼Œæ–¹ä¾¿æ“ä½œ</li>
<li>Set as StartUp: è®¾ç½®ä¸ºåˆå§‹ Groupï¼Œæ¸¸æˆå¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨åŠ è½½ï¼Œä¸èƒ½è¢« Unload</li>
</ul>
<p>æˆ‘ä»¬æŠŠ MainGroup è®¾ç½®ä¸ºå¯åŠ¨åŠ è½½</p>
<p>åœ¨ MainGroup å³è¾¹çš„å°èœå•é‡Œé¢é€‰æ‹© Camera æ–°å¢ä¸€ä¸ª Camera</p>
<p>å† Create Emptyï¼Œæ–°å»ºä¸€ä¸ªç©ºç»„ä»¶ï¼Œå‘½åä¸º Spawnerï¼Œç”¨æ¥äº§ç”Ÿçƒçƒ</p>
<p>å† Create Emptyï¼Œæ–°å»ºä¸€ä¸ªç©ºç»„ä»¶ï¼Œå‘½åä¸º Borderï¼Œä½œä¸ºè¾¹ç•Œ</p>
<p>å¯¼å…¥ä¸€ä¸ªçŸ©å½¢ Sprite, è¿™é‡Œå¯¼å…¥ Sprite çš„æ–¹å¼å’Œ Unity æœ¬ä½“æ˜¯ä¸€æ ·çš„ï¼Œå°±ä¸å¤šè¯´æ˜äº†</p>
<p>åœ¨ Border ä¸‹é¢ Create 2D Object -&gt; Sprite  </p>
<p>åš4ä¸ªè¾¹</p>
<p>ç»™4ä¸ªè¾¹åŠ ä¸Š RigidBody2D å’Œ BoxCollider2D æ¥åšç‰©ç†æ•ˆæœ</p>
<img src="/2018/12/10/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AProjectTiny%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%E5%BC%B9%E7%90%83%E5%92%8C2D%E7%89%A9%E7%90%86/hierarchy.jpg" class="" title="å¦‚å›¾">

<p>åˆšä½“å’Œç¢°æ’æ£€æµ‹çš„é€‰é¡¹éƒ½æ¯”è¾ƒç®€å•</p>
<p>è¯´ä¸€ä¸‹åˆšä½“çš„å‡ ä¸ª BodyType</p>
<ul>
<li>Staticï¼šé™æ€ï¼Œä¸åšç‰©ç†æ¨¡æ‹Ÿï¼Œè´¨é‡æ— é™ï¼Œä¸ä¼šåŒå…¶ä»– static å’Œ kinematic åšç¢°æ’æ£€æµ‹</li>
<li>Kinematicï¼šè¿åŠ¨å­¦ï¼Œè´¨é‡æ— é™ï¼Œè¿åŠ¨é  velocityï¼Œè´¨é‡æ— é™ï¼Œæ‰€ä»¥ä¸å—åŠ›çš„ä½œç”¨ï¼Œä¸ä¼šåŒå…¶ä»– static å’Œ kinematic åšç¢°æ’æ£€æµ‹ï¼Œç§»åŠ¨é è®¾ç½®ä»–çš„ Position æˆ– velocity</li>
<li>Dynamicï¼šåŠ¨æ€ï¼Œå…¨ç‰©ç†æ¨¡æ‹Ÿï¼Œå’Œå…¶ä»–ä¸‰ç§ç±»å‹çš„åˆšä½“åšç¢°æ’æ£€æµ‹ï¼Œä¸€èˆ¬é ç»™å…¶æ–½åŠ ä¸€ä¸ªåŠ›æ¥è¿åŠ¨ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥è®¾ç½® velocity å’Œ Position ä½†æ˜¯æ„ä¹‰ä¸å¤§</li>
<li>BulletDynamicï¼šå­å¼¹åŠ¨æ€ï¼Œå’ŒåŠ¨æ€å·®ä¸å¤šï¼Œä½†æ˜¯ä½¿ç”¨çš„è¿ç»­ç¢°æ’æ£€æµ‹ï¼Œæ›´ç²¾ç¡®ï¼Œä¹Ÿæ›´æ¶ˆè€—èµ„æºï¼Œå¥½å¤„æ˜¯ä¸ä¼šå› ä¸ºé€Ÿåº¦è¿‡å¿«è€Œç©¿è¿‡å…¶ä»–åˆšä½“</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬çš„è¾¹ç•Œé€‰æ‹©ä»€ä¹ˆå¾ˆæ˜æ˜¾äº†-&gt; Static</p>
<p>å…¶ä»–å‡ ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>freezeRotationï¼šå¦‚æœ true åˆ™ä¸èƒ½æ—‹è½¬</li>
<li>frictionï¼šæ‘©æ“¦åŠ›ï¼Œ0 ä»£è¡¨æ— æ‘©æ“¦ï¼Œ1 ä»£è¡¨å¤§æ‘©æ“¦ï¼Œ1 ä»¥ä¸Šä»£è¡¨æ¯” 1 å¤§çš„æ‘©æ“¦ï¼ˆåºŸè¯ï¼‰</li>
<li>restitutionï¼šå¼¹æ€§ç³»æ•°ï¼Œ0 ä»£è¡¨å®Œå…¨å¸æ”¶ï¼Œ1 ä»£è¡¨å®Œå…¨åå¼¹</li>
<li>densityï¼šå¯†åº¦ï¼Œå†³å®šåˆšä½“çš„ è´¨é‡ = å¯†åº¦ * ä½“ç§¯</li>
</ul>
<p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©å…¨åå¼¹ restitution è®¾ç½®ä¸º 1</p>
<h3 id="è‡ªå®šä¹‰æˆ‘ä»¬çš„äº§ç”Ÿå™¨-spawner"><a href="#è‡ªå®šä¹‰æˆ‘ä»¬çš„äº§ç”Ÿå™¨-spawner" class="headerlink" title="è‡ªå®šä¹‰æˆ‘ä»¬çš„äº§ç”Ÿå™¨ spawner"></a>è‡ªå®šä¹‰æˆ‘ä»¬çš„äº§ç”Ÿå™¨ spawner</h3><p>æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªç»„ä»¶æ¥äº§ç”Ÿå°çƒ</p>
<p>åœ¨ èœå• -&gt; Tiny -&gt; Component </p>
<p>æ–°å»ºä¸€ä¸ª Spawner ç»„ä»¶</p>
<p>ç‚¹å‡»ç»„ä»¶ï¼Œåœ¨ inspector ä¸­å¯ä»¥å¯¹å…¶å­—æ®µæ¥åšä¿®æ”¹</p>
<p>å¦‚æœ hide_flags è®¾ç½®ä¸º hide in inspectors åˆ™åœ¨å±‚çº§å›¾ä¸­å³ä½¿æ·»åŠ åˆ°å®ä½“ä¸Šäº†ä¹Ÿä¸ä¼šæ˜¾ç¤ºå‡ºæ¥</p>
<p>add new field å¯ä»¥æ·»åŠ ä»»æ„å¯ç©çš„æ•°å€¼å’Œå±æ€§ç±»å‹</p>
<p>ç‚¹å‡»å±æ€§åç§°å¯ä»¥ä¿®æ”¹ä¹‹ï¼Œä¸‹é¢å¯ä»¥è®¾ç½®é»˜è®¤å€¼</p>
<p>æœ€åè®¾ç½®å¦‚ä¸‹</p>
<p>æˆ‘ä»¬åœ¨å»¶æ—¶ 1.5s åæ¯ 1.5s åˆ›å»ºä¸€ä¸ª spawnedGroup çš„å®ä½“ æœ€å¤š maxCount ä¸ª</p>
<p>ç±»å‹å³è¾¹çš„ 3 ä¸ªå›¾æ ‡åˆ†åˆ«æ˜¯</p>
<ul>
<li>æ˜¯å¦æ•°ç»„ç±»å‹</li>
<li>ç¼–è¾‘å™¨æ˜¯å¦å¯è§ï¼šæ¯”å¦‚æˆ‘ä»¬çš„ curCount è¿™ä¸ªå­—æ®µç¼–è¾‘å™¨ä¸å¯è§ï¼Œå› ä¸ºæ˜¯ä¸ç”¨ç¼–è¾‘ä¹Ÿä¸èƒ½ç¼–è¾‘</li>
<li>å­èœå• å­—é¢ä¸Šçš„æ„æ€ï¼ŒDocument é€‰é¡¹åº”è¯¥å’Œè‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£çš„å†…å®¹æœ‰å…³</li>
</ul>
<img src="/2018/12/10/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AProjectTiny%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%E5%BC%B9%E7%90%83%E5%92%8C2D%E7%89%A9%E7%90%86/component_inspector.jpg" class="" title="å¦‚å›¾">

<p>ç”Ÿæˆå™¨ç»„ä»¶æœ‰äº†ï¼Œæˆ‘ä»¬ç»§ç»­æ¥æç”Ÿæˆç³»ç»Ÿ</p>
<p>èœå•ï¼Œåˆ›å»º TypeScript System ï¼ˆåé¢çœç•¥å“ªé‡Œçš„èœå•äº†å“¦ï¼‰</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> game &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** New System */</span></span><br><span class="line">    <span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">NewSystem</span> <span class="keyword">extends</span> <span class="title">ut</span>.<span class="title">ComponentSystem</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        OnUpdate():<span class="built_in">void</span> &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†ä¸€ä¸ªç»§æ‰¿ ut.ComponentSystem çš„ç±»ï¼Œé‡å†™ä¸€ä¸ª OnUpdate å‡½æ•°</p>
<p>æ˜¯ä¸æ˜¯å’Œ Unity ECS çš„æ–¹å¼ä¸€æ¯›ä¸€æ ·</p>
<p>ut æ˜¯ unity tiny çš„ç®€ç§°</p>
<p>æ–‡ä»¶åä¿®æ”¹ä¸º SpawnSystem</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> game &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">SpawnSystem</span> <span class="keyword">extends</span> <span class="title">ut</span>.<span class="title">ComponentSystem</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        OnUpdate(): <span class="built_in">void</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.world.forEach([game.Spawner], <span class="function">(<span class="params">spawner</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (spawner.isPaused)</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> time = spawner.time;</span><br><span class="line">                <span class="keyword">let</span> delay = spawner.delay;</span><br><span class="line"></span><br><span class="line">                time -= ut.Time.deltaTime();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (time &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    time += delay;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">&quot;spawn&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (spawner.curCount &lt; spawner.maxCount) &#123;</span><br><span class="line">                        ut.EntityGroup.instantiate(<span class="built_in">this</span>.world, spawner.spawnedGroup);</span><br><span class="line">                        spawner.curCount++</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                spawner.time = time;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»£ç å¦‚ä¸Šï¼Œå¾ªç¯ World ä¸­çš„æ¯ä¸€ä¸ª Spawner æ¥æ“ä½œ</p>
<p>è‡³æ­¤ï¼Œç”Ÿæˆå™¨ç»„ä»¶å®Œæˆï¼Œæˆ‘ä»¬åœ¨ MainGroup çš„ Spawn å…ƒç´ çš„ insepector ä¸­ç‚¹å‡» Add Tiny Component å¢åŠ ä¸€ä¸ª Spawner ç»„ä»¶</p>
<p>äºæ˜¯å°±å¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­è®¾ç½®è¿™ä¸ªè‡ªå®šç»„ä»¶çš„å€¼äº†</p>
<p>spawnedGroup è®¾ç½®ä¸º game.BallGroup</p>
<p>maxCount è®¾ç½®ä¸º 10</p>
<hr>
<h2 id="åˆ›å»ºçƒçƒå®ä½“"><a href="#åˆ›å»ºçƒçƒå®ä½“" class="headerlink" title="åˆ›å»ºçƒçƒå®ä½“"></a>åˆ›å»ºçƒçƒå®ä½“</h2><p>åˆ›å»ºæ–°çš„å®ä½“ç»„ åä¸º BallGroup</p>
<p>ç‚¹å‡» Load æŒ‰é’®</p>
<p>æ”¾åˆ°å±‚çº§å›¾ä¸­</p>
<p>åŠ å…¥ä¸€ä¸ª 2d sprite UnitBall å¦‚å›¾</p>
<p>æ–°å»ºä¸€ä¸ªæ–°çš„ç©ºç»„ä»¶ BallFlag ç”¨æ¥ä»£è¡¨å®ä½“æ˜¯çƒçƒ</p>
<p>å†å¢åŠ  CircleCollider2D RigidBody2D ç»„ä»¶åˆ°çƒçƒ</p>
<p>è°ƒæ•´å¥½åœ†å½¢æ£€æµ‹çš„åŠå¾„</p>


<p>åšå¥½ä¹‹å Unload BallGroupï¼Œåé¢æˆ‘ä»¬éƒ½é€šè¿‡ Spawner æ¥ç”Ÿæˆçƒçƒ</p>
<h3 id="çƒçƒçš„è¡Œä¸º"><a href="#çƒçƒçš„è¡Œä¸º" class="headerlink" title="çƒçƒçš„è¡Œä¸º"></a>çƒçƒçš„è¡Œä¸º</h3><p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè„šæœ¬æ¥æ§åˆ¶çƒçƒç”Ÿæˆçš„åœ°æ–¹ï¼Œå¹¶ä¸”ç»™ä¸€ä¸ªåŠ›è®©ä»–è·‘èµ·æ¥</p>
<p>èœå• åˆ›å»º TypeScript Behavior</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> game &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">NewBehaviourFilter</span> <span class="keyword">extends</span> <span class="title">ut</span>.<span class="title">EntityFilter</span> </span>&#123;</span><br><span class="line">        <span class="attr">node</span>: ut.Core2D.TransformNode;</span><br><span class="line">        position?: ut.Core2D.TransformLocalPosition;</span><br><span class="line">        rotation?: ut.Core2D.TransformLocalRotation;</span><br><span class="line">        scale?: ut.Core2D.TransformLocalScale;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">NewBehaviour</span> <span class="keyword">extends</span> <span class="title">ut</span>.<span class="title">ComponentBehaviour</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="attr">data</span>: NewBehaviourFilter;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ComponentBehaviour lifecycle events</span></span><br><span class="line">        <span class="comment">// uncomment any method you need</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// this method is called for each entity matching the NewBehaviourFilter signature, once when enabled</span></span><br><span class="line">        <span class="comment">//OnEntityEnable():void &#123; &#125;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// this method is called for each entity matching the NewBehaviourFilter signature, every frame it&#x27;s enabled</span></span><br><span class="line">        <span class="comment">//OnEntityUpdate():void &#123; &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// this method is called for each entity matching the NewBehaviourFilter signature, once when disabled</span></span><br><span class="line">        <span class="comment">//OnEntityDisable():void &#123; &#125;</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>NewBehaviourFilter ç›¸å½“äºæ˜¯ Unity ECS ä¸­çš„ GetEntityGroup ä¸­çš„ struct</p>
<p>å°†ä¼šè·å¾—æœ‰è¿™ä¸ªè¿‡æ»¤å™¨ä¸‹å­—æ®µçš„æ‰€æœ‰ Entity</p>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™ UnitBall å¢åŠ ä¸€ä¸ª ç©ºçš„ BallFlag æ¥ç¡®è®¤ä»–æ˜¯çƒçƒ</p>
<ul>
<li>OnEntityEnable. Called only once, the first frame this entity is matched by this behaviour. è·å¾—æ­¤Entityçš„ç¬¬ä¸€å¸§æ‰§è¡Œ</li>
<li>OnEntityUpdate. Called every frame on matching entities. </li>
<li>OnEntityDisable. Called only once, the first frame this entity is marked as disabled by this behaviour. è®¾ç½®ä¸º disable çš„ç¬¬ä¸€å¸§æ‰§è¡Œ</li>
</ul>
<p>çƒçƒè¡Œä¸ºä»£ç å¦‚ä¸‹</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> game &#123;</span><br><span class="line">    <span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">BallBehaviorFilter</span> <span class="keyword">extends</span> <span class="title">ut</span>.<span class="title">EntityFilter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="attr">position</span>: ut.Core2D.TransformLocalPosition;</span><br><span class="line">        entity: ut.Entity;</span><br><span class="line">        ball: game.BallFlag;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">BallBehavior</span> <span class="keyword">extends</span> <span class="title">ut</span>.<span class="title">ComponentBehaviour</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="attr">data</span>: BallBehaviorFilter;</span><br><span class="line"></span><br><span class="line">        OnEntityEnable(): <span class="built_in">void</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;ball Enabled&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// éšæœºçƒçƒå‡ºç°çš„ä½ç½®</span></span><br><span class="line">            <span class="keyword">let</span> randomX = getRandom(-<span class="number">100</span>, <span class="number">100</span>)</span><br><span class="line">            <span class="keyword">let</span> randomY = getRandom(-<span class="number">100</span>, <span class="number">100</span>)</span><br><span class="line">            <span class="built_in">this</span>.data.position.position = <span class="keyword">new</span> Vector3(randomX, randomY, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// éšæœºç»™çƒçƒä¸€ä¸ªåŠ›ï¼ŒåŠ¨èµ·æ¥</span></span><br><span class="line">            <span class="comment">// æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œç”¨äº† this.world.addComponentData ç»™çƒçƒæ·»åŠ äº†ä¸€ä¸ªåŠ åŠ›ç»„ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç»„ä»¶</span></span><br><span class="line">            <span class="comment">// è¿™é‡Œçš„ AddImpulse2D ç»„ä»¶ä¼šåœ¨è¿™ä¸€å¸§ä¹‹åè‡ªåŠ¨æ¶ˆå¤±æ‰</span></span><br><span class="line">            <span class="keyword">let</span> impulse = <span class="keyword">new</span> ut.Physics2D.AddImpulse2D;</span><br><span class="line">            <span class="keyword">let</span> newImpulse = <span class="keyword">new</span> Vector2(getRandom(-<span class="number">1</span>, <span class="number">1</span>), getRandom(-<span class="number">1</span>, <span class="number">1</span>)).normalize();</span><br><span class="line">            impulse.impulse = <span class="keyword">new</span> Vector2(newImpulse.x * <span class="number">100</span>, newImpulse.y * <span class="number">100</span>);</span><br><span class="line">            <span class="built_in">this</span>.world.addComponentData(<span class="built_in">this</span>.data.entity, impulse);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;ball created:&quot;</span> + <span class="built_in">this</span>.data.position.position);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        OnEntityUpdate(): <span class="built_in">void</span> &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params">min, max</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.random() * (max - min + <span class="number">1</span>) + min;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><p>åˆ°æ­¤æˆ‘ä»¬çš„å·¥ä½œå‘Šä¸€æ®µè½ï¼Œunity æ‰§è¡Œå</p>
<p>ä¼šåœ¨æˆ‘ä»¬çš„é»˜è®¤æµè§ˆå™¨æ‰“å¼€ä¸€ä¸ªçª—å£</p>
<img src="/2018/12/10/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AProjectTiny%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%E5%BC%B9%E7%90%83%E5%92%8C2D%E7%89%A9%E7%90%86/run_game.jpg" class="" title="è¿è¡Œæ—¶ Unity çš„ Game çª—å£">

<p>åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨å¼€å‘è€…æ¨¡å¼å¯ä»¥çœ‹åˆ°æ‰“å°</p>
<p>ä¹Ÿå¯ä»¥æ‰«æäºŒç»´ç åœ¨ç§»åŠ¨è®¾å¤‡ä¸ŠæŸ¥çœ‹æ•ˆæœ</p>
<p>è¿è¡Œæ•ˆæœå¦‚å›¾</p>
<img src="/2018/12/10/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AProjectTiny%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%E5%BC%B9%E7%90%83%E5%92%8C2D%E7%89%A9%E7%90%86/tiny_run.gif" class="" title="è¿è¡Œ">

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mapz.github.io/2018/12/10/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AProjectTiny%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89%E5%88%9D%E8%AF%86Tiny%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/link-300x300.gif">
      <meta itemprop="name" content="Mapz">
      <meta itemprop="description" content="FIND THE CHILD">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mapz's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/10/Unity%E5%AD%A6%E4%B9%A0%EF%BC%9AProjectTiny%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89%E5%88%9D%E8%AF%86Tiny%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">Unityå­¦ä¹ ï¼šProjectTinyå­¦ä¹ ï¼ˆä¸€ï¼‰åˆè¯†Tinyæ¨¡å¼</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-12-10 11:10:56" itemprop="dateCreated datePublished" datetime="2018-12-10T11:10:56+08:00">2018-12-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-22 10:15:32" itemprop="dateModified" datetime="2021-04-22T10:15:32+08:00">2021-04-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Project-Tiny-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Project-Tiny-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Project Tiny æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Project Tiny æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>2018å¹´12æœˆï¼ŒUnityåœ¨2018.3betaç‰ˆæœ¬ä¸Šå¼€æ”¾äº†ä¸€ä¸ªæ–°åŒ…çš„é¢„è§ˆä¸‹è½½ï¼Œå«åšProjectTiny</p>
<p>å¹¶å‘å¸ƒäº†ä¸€ä¸ªåŸºäºæ­¤æ¥åˆ¶ä½œçš„ç½‘é¡µæ¸¸æˆ</p>
<p><a target="_blank" rel="noopener" href="https://blogs.unity3d.com/cn/2018/12/05/project-tiny-preview-package-is-here/">åŸæ–‡Blogä¼ é€é—¨</a></p>
<p><a target="_blank" rel="noopener" href="https://tiny-match3.storage.googleapis.com/index.html">Tiny Arms Revenge æ¸¸æˆä½“éªŒåœ°å€ï¼ˆéœ€ç§‘å­¦ä¸Šç½‘ï¼‰</a></p>
<p>Project Tiny çš„ç›®çš„ï¼Œæ˜¯ä¸ºæ›´å¤šå³å¼€å³ç©çš„æ¸¸æˆå’Œäº’åŠ¨å¹¿å‘Šæä¾›æ”¯æŒ</p>
<p>ç°åœ¨å¯ä»¥åˆ¶ä½œ2Dç±»å‹çš„Webæ¸¸æˆ</p>
<p>ä½“éªŒæ¸¸æˆå¤§å°ä»…ä»…åªæœ‰ 1.8 MBï¼Œå¯åŠ¨åªéœ€ä¸‹è½½ 969 KB</p>
<hr>
<h2 id="Project-Tiny-ç°åœ¨æ˜¯ä»€ä¹ˆæƒ…å†µï¼Œä»¥åä¼šæ€ä¹ˆæ ·ï¼Ÿ"><a href="#Project-Tiny-ç°åœ¨æ˜¯ä»€ä¹ˆæƒ…å†µï¼Œä»¥åä¼šæ€ä¹ˆæ ·ï¼Ÿ" class="headerlink" title="Project Tiny ç°åœ¨æ˜¯ä»€ä¹ˆæƒ…å†µï¼Œä»¥åä¼šæ€ä¹ˆæ ·ï¼Ÿ"></a>Project Tiny ç°åœ¨æ˜¯ä»€ä¹ˆæƒ…å†µï¼Œä»¥åä¼šæ€ä¹ˆæ ·ï¼Ÿ</h2><p>ç°åœ¨æ­£åœ¨é¢„è§ˆç‰ˆæœ¬ï¼Œåªæ”¯æŒ2Dæ¸¸æˆï¼Œåªæ”¯æŒTSè¯­è¨€ï¼Œå°†æ¥ä¼šæ”¯æŒC#ï¼Œå¹¶ç§»é™¤TSæ”¯æŒï¼Œå¹¶ä¸”ä¸æ–­å®Œå–„å·¥å…·é“¾å’Œç‰¹æ€§ï¼Œå¹¶æ”¯æŒ3Då’ŒARä½“éªŒ</p>
<hr>
<h2 id="Project-Tiny-çš„ç‰¹è‰²å’Œäº®ç‚¹ï¼Ÿ"><a href="#Project-Tiny-çš„ç‰¹è‰²å’Œäº®ç‚¹ï¼Ÿ" class="headerlink" title="Project Tiny çš„ç‰¹è‰²å’Œäº®ç‚¹ï¼Ÿ"></a>Project Tiny çš„ç‰¹è‰²å’Œäº®ç‚¹ï¼Ÿ</h2><ul>
<li>çº¯çš„ECSæ¨¡å¼ï¼Œæˆ–è®¸å…¶ç¼–è¾‘å™¨å¯ä»¥çœ‹åšæœªæ¥Unityçš„ECSæ­£å¼ç‰ˆç¼–è¾‘å™¨çš„ä¸€ä¸ªé¢„è§ˆ</li>
<li>ECSæ¨¡å¼å¸¦æ¥çš„æ•ˆç‡æé«˜</li>
<li>å¿«é€Ÿåˆ¶ä½œæ¸¸æˆå’Œäº’åŠ¨å¹¿å‘Š</li>
</ul>
<hr>
<h2 id="æˆ‘çš„æ„Ÿè§‰"><a href="#æˆ‘çš„æ„Ÿè§‰" class="headerlink" title="æˆ‘çš„æ„Ÿè§‰"></a>æˆ‘çš„æ„Ÿè§‰</h2><p>Project Tiny é¡¾åæ€ä¹‰å°±æ˜¯ä¸€ä¸ªç²¾å¹²ç‰ˆæœ¬çš„ Unity å•¦ï¼Œç”¨æ¥åˆ¶ä½œ web å†…å®¹ï¼Œå¹¶ä¸”å…¶ ECS æ¨¡å¼å¾ˆå¯èƒ½å°±æ˜¯ä»¥åçš„ Unity ECS æ¨¡å¼çš„é¢„è§ˆï¼Œå­¦ä¹  Project Tiny å¯¹äºæˆ‘ä»¬è¿›ä¸€æ­¥ç†Ÿæ‚‰ Unity ECS å’Œæå‰ç†Ÿæ‚‰æ–°çš„ç¼–è¾‘å™¨éƒ½æœ‰å¥½å¤„</p>
<hr>
<h2 id="å¦‚ä½•å¼€å§‹åˆ¶ä½œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Ÿ"><a href="#å¦‚ä½•å¼€å§‹åˆ¶ä½œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Ÿ" class="headerlink" title="å¦‚ä½•å¼€å§‹åˆ¶ä½œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Ÿ"></a>å¦‚ä½•å¼€å§‹åˆ¶ä½œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Ÿ</h2><ol>
<li>ä¸‹è½½ Unity 2018.3 Beta</li>
<li>æ‰“å¼€ Windows -&gt; package manager</li>
<li>ç‚¹å‡» Advancedï¼Œå‹¾é€‰ show preview packages </li>
<li>ä¸‹è½½ Tiny Mode åŒ…</li>
<li>èœå•æ–°å¢é¡¹ç›® Tinyï¼Œè¡¨ç¤ºä¸€åˆ‡ OK</li>
<li>Tiny -&gt; File -&gt; NewProject æ–°å»ºé¡¹ç›®</li>
</ol>
<h2 id="ä¾‹å­é¡¹ç›®åœ¨å“ªé‡Œï¼Ÿ"><a href="#ä¾‹å­é¡¹ç›®åœ¨å“ªé‡Œï¼Ÿ" class="headerlink" title="ä¾‹å­é¡¹ç›®åœ¨å“ªé‡Œï¼Ÿ"></a>ä¾‹å­é¡¹ç›®åœ¨å“ªé‡Œï¼Ÿ</h2><p>èœå• Tiny -&gt; Import Samples ä¼šåŠ è½½ä¾‹å­åˆ°é¡¹ç›®ä¸­</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Mapz"
      src="/images/link-300x300.gif">
  <p class="site-author-name" itemprop="name">Mapz</p>
  <div class="site-description" itemprop="description">FIND THE CHILD</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">38</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Mapz" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Mapz" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">true</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>















  

  

</body>
</html>
